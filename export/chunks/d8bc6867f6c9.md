---
chunk_index: 838
ref: "d8bc6867f6c9"
id: "d8bc6867f6c985c3e53e51bfc8ff833db939eceff247d34b96789d89e680fc9a"
slug: "stable-backport-patches--web-worker-js-clear-stale-embeddings-after-s"
path: "/home/zack/dev/llmx/docs/STABLE_BACKPORT_PATCHES.md"
kind: "markdown"
lines: [10, 28]
token_estimate: 116
content_sha256: "8c01064877343b80080e37d299cac1a2eee6517791ab792765ae456b47c4f3a7"
compacted: false
heading_path: ["LLMX Stable - Exact Code Patches to Apply","PATCH 1: Critical Bug Fixes (Priority: CRITICAL)","web/worker.js - Clear stale embeddings after selective update"]
symbol: null
address: null
asset_path: null
---

### web/worker.js - Clear stale embeddings after selective update

**Location:** After line ~466 (in updateSelective handler)

```javascript
await ingestor.updateSelective(files, payload.keepPaths || [], null);

// ADD THESE 3 LINES:
embeddings = null;
embeddingsMeta = null;
chunkMeta = null;

self.postMessage({ id, ok: true, data: { updated: true } });
```

**Impact:** Fixes HIGH SEVERITY bug where semantic search uses stale vectors after index updates

---