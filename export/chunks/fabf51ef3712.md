---
chunk_index: 1270
ref: "fabf51ef3712"
id: "fabf51ef3712f8f272a0446c29e703b5388ce3975819a04ad59056a8654898a8"
slug: "ingestor-wasm--wbg-load"
path: "/home/zack/dev/llmx/ingestor-wasm/web/pkg/ingestor_wasm.js"
kind: "java_script"
lines: [396, 424]
token_estimate: 299
content_sha256: "f21f0287dcffa464b7c5dd2cea559a1592a0eb13a302b1e826efcaaf790f7992"
compacted: false
heading_path: []
symbol: "__wbg_load"
address: null
asset_path: null
---

async function __wbg_load(module, imports) {
    if (typeof Response === 'function' && module instanceof Response) {
        if (typeof WebAssembly.instantiateStreaming === 'function') {
            try {
                return await WebAssembly.instantiateStreaming(module, imports);
            } catch (e) {
                const validResponse = module.ok && EXPECTED_RESPONSE_TYPES.has(module.type);

                if (validResponse && module.headers.get('Content-Type') !== 'application/wasm') {
                    console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n", e);

                } else {
                    throw e;
                }
            }
        }

        const bytes = await module.arrayBuffer();
        return await WebAssembly.instantiate(bytes, imports);
    } else {
        const instance = await WebAssembly.instantiate(module, imports);

        if (instance instanceof WebAssembly.Instance) {
            return { instance, module };
        } else {
            return instance;
        }
    }
}