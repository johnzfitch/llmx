---
chunk_index: 1203
ref: "1756cc740457"
id: "1756cc74045707a91df93455d708c386de89324dc05e722001f3a1024e1d91be"
slug: "mcp-tests-l248-293"
path: "/home/zack/dev/llmx/ingestor-core/tests/mcp_tests.rs"
kind: "text"
lines: [248, 293]
token_estimate: 348
content_sha256: "f60788bc964224845edd6919d6bf134ccbc608e4de172549e1e0a5bd0a515f73"
compacted: false
heading_path: []
symbol: null
address: null
asset_path: null
---

let handler_input: ingestor_core::handlers::ManageInput = mcp_input.into();

    assert_eq!(handler_input.action, "delete");
    assert_eq!(handler_input.index_id, Some("test-id".to_string()));
}

// ============================================================================
// Edge Cases
// ============================================================================

#[test]
fn test_mcp_empty_paths_array() {
    let json = r#"{"paths": []}"#;
    let result: Result<IndexInputMcp, _> = serde_json::from_str(json);
    // Empty paths should deserialize (handler will validate)
    assert!(result.is_ok());
}

#[test]
fn test_mcp_unknown_fields_ignored() {
    let json = r#"{
        "index_id": "abc123",
        "query": "test",
        "unknown_field": "ignored",
        "another_unknown": 42
    }"#;
    // Should deserialize successfully, ignoring unknown fields
    let result: Result<SearchInputMcp, _> = serde_json::from_str(json);
    assert!(result.is_ok());
}

#[test]
fn test_mcp_null_optional_fields() {
    let json = r#"{
        "index_id": "abc123",
        "query": "test",
        "filters": null,
        "limit": null,
        "max_tokens": null
    }"#;
    let input: SearchInputMcp = serde_json::from_str(json).expect("Should deserialize");

    assert!(input.filters.is_none());
    assert!(input.limit.is_none());
    assert!(input.max_tokens.is_none());
}