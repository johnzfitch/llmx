---
chunk_index: 1340
ref: "afe5b65029e2"
id: "afe5b65029e21578cd9f40513abc765fde7c9bb5cffb7409e4ff07378ddd672c"
slug: "app--fingerprintfile"
path: "/home/zack/dev/llmx/web/app.js"
kind: "java_script"
lines: [359, 379]
token_estimate: 194
content_sha256: "9d71d4f16fa85a81e3416c0fa053d4e6e0b260214c3df19396f8c74254447b08"
compacted: false
heading_path: []
symbol: "fingerprintFile"
address: null
asset_path: null
---

async function fingerprintFile(file) {
  const size = file.size;
  const headLen = 4096;
  const tailLen = 4096;
  if (size <= headLen + tailLen) {
    const full = await file.arrayBuffer();
    return sha256Hex(full);
  }
  const head = await file.slice(0, headLen).arrayBuffer();
  const tail = await file.slice(size - tailLen, size).arrayBuffer();

  const sizeBytes = new Uint8Array(8);
  const view = new DataView(sizeBytes.buffer);
  view.setBigUint64(0, BigInt(size), true);

  const combined = new Uint8Array(sizeBytes.byteLength + head.byteLength + tail.byteLength);
  combined.set(sizeBytes, 0);
  combined.set(new Uint8Array(head), sizeBytes.byteLength);
  combined.set(new Uint8Array(tail), sizeBytes.byteLength + head.byteLength);
  return sha256Hex(combined);
}