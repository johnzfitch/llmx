---
chunk_index: 1343
ref: "6cbcbf0d9437"
id: "6cbcbf0d94371dbc5dcb944863f9eefb768b12809f819fcf4fb87c311e9f3fc2"
slug: "app--runsearch"
path: "/home/zack/dev/llmx/web/app.js"
kind: "java_script"
lines: [681, 719]
token_estimate: 282
content_sha256: "aaf04cf24162457a908a9b6273b39c187878b6bb3fed1d6eeb58bb24c1b53d09"
compacted: false
heading_path: []
symbol: "runSearch"
address: null
asset_path: null
---

async function runSearch() {
  if (!state.indexLoaded) {
    setStatus("No index loaded.");
    return;
  }
  const query = elements.query.value.trim();
  if (!query) {
    elements.results.replaceChildren();
    elements.chunkView.hidden = true;
    setStatus("Index ready.");
    return;
  }
  const filters = {
    path_exact: elements.fileFilter.value || null,
    path_prefix: elements.fileFilter.value ? null : selectPathPrefix(),
    kind: elements.kindFilter.value || null,
    heading_prefix: elements.outlineFilter.value || null,
    symbol_prefix: elements.symbolFilter.value || null,
  };
  const seq = ++state.searchSeq;
  elements.runSearch.disabled = true;
  setStatus("Searching...");
  try {
    const { results } = await callWorker("search", { query, filters, limit: 20 });
    if (seq !== state.searchSeq) {
      return;
    }
    renderResults(results);
    setStatus(`Found ${results.length} results.`);
  } catch (error) {
    if (seq === state.searchSeq) {
      setStatus("Search failed.");
    }
  } finally {
    if (seq === state.searchSeq) {
      elements.runSearch.disabled = false;
    }
  }
}