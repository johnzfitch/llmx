---
chunk_index: 648
ref: "d399917c0ac3"
id: "d399917c0ac34ec436503bf690a2726bf9f34d565cf58570075bf8b90e600ae3"
slug: "phase-5-completion-report--updated-storedindex-src-mcp-storage-rs-8-21"
path: "/home/zack/dev/llmx/docs/PHASE_5_COMPLETION_REPORT.md"
kind: "markdown"
lines: [165, 184]
token_estimate: 137
content_sha256: "877432a2e603af30b53aff599b301dcbcee18adcba8be40b60ab202af3c5277d"
compacted: false
heading_path: ["Phase 5 Completion Report: Semantic Search Integration","Implementation Summary","5. Storage Format","Updated StoredIndex (src/mcp/storage.rs:8-21)"]
symbol: null
address: null
asset_path: null
---

#### Updated StoredIndex (src/mcp/storage.rs:8-21)
```rust
struct StoredIndex {
    // ... existing fields ...

    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub embeddings: Option<Vec<Vec<f32>>>,

    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub embedding_model: Option<String>,
}
```

- Embeddings persisted to disk with index
- Backward compatible: Old indexes work (embeddings = None)
- Skip serialization when None (smaller disk usage)
- Typical overhead: ~1.5KB per chunk (384 floats Ã— 4 bytes)

---