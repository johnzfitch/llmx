---
chunk_index: 870
ref: "68344769baff"
id: "68344769baff5471051fbdc73585bb6a2eab81e2feda92c7eb796066dd818c98"
slug: "stable-backport-plan--2-1-firefox-memory-crashes-with-cpu-embeddin"
path: "/home/zack/dev/llmx/docs/STABLE_BACKPORT_PLAN.md"
kind: "markdown"
lines: [99, 125]
token_estimate: 207
content_sha256: "e6316ca6cd6915e213400d686189bef74865d7617a2c2c187f9659dc73358e50"
compacted: false
heading_path: ["LLMX Stable Version - Backport Analysis & Hardening Plan","2. STABILITY & RELIABILITY FIXES","2.1 Firefox Memory Crashes with CPU Embeddings"]
symbol: null
address: null
asset_path: null
---

### 2.1 Firefox Memory Crashes with CPU Embeddings
**Commits:** 0e3fe88, 9585715
**Severity:** MEDIUM
**Impact:** Firefox crashes when processing >100 chunks with CPU embeddings

**Problem:**
Default batch size (8) exhausts WASM memory in Firefox. Firefox has stricter memory limits than Chrome/Edge.

**Fix Required:**
```javascript
// web/worker.js - Reduce batch size for Firefox
const batchSize = isFirefox ? 1 : 2; // Down from 8
// Add yield points every 5 batches
// Add warning dialog for >100 chunks

// web/app.js - Firefox-specific warnings
if (isFirefox && chunkCount > 100) {
  confirm("Firefox CPU embeddings may be slow. Continue?");
}
```

**Files:** `web/app.js`, `web/worker.js` (~30 lines)
**Risk:** Low - Browser detection is reliable, graceful degradation
**Priority:** ðŸŸ¡ HIGH (if CPU embeddings used)

---