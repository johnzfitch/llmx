---
chunk_index: 692
ref: "a11340f79f09"
id: "a11340f79f091a16394c23beee38c302231b1025de6bae1198156d6708536462"
slug: "phase-5-directions--5-embedding-cache-updates"
path: "/home/zack/dev/llmx/docs/PHASE_5_DIRECTIONS.md"
kind: "markdown"
lines: [118, 144]
token_estimate: 190
content_sha256: "e5c9934e8c260d5468ba93efe5336782d30f8fdfaaec27b10c8f229e88de6f19"
compacted: false
heading_path: ["Phase 5: Semantic Search & Embeddings Integration","Primary Objectives","5. Embedding Cache & Updates"]
symbol: null
address: null
asset_path: null
---

### 5. Embedding Cache & Updates
**Goal**: Avoid regenerating embeddings unnecessarily

**Cache Strategy**:
```rust
pub struct EmbeddingCache {
    // Map from (content_hash, model_id) -> embedding
    cache: HashMap<(String, String), Vec<f32>>,
    max_size: usize,  // LRU eviction
}
```

**Tasks**:
- [ ] Implement content-based cache keying (hash of chunk content)
- [ ] Add LRU eviction for cache size limits
- [ ] Persist cache to disk between runs
- [ ] Handle model version changes (invalidate old embeddings)

**Update Logic**:
```
On index update:
  1. Identify changed chunks (content hash comparison)
  2. Generate embeddings only for new/modified chunks
  3. Reuse cached embeddings for unchanged chunks
  4. Update vector index incrementally
```