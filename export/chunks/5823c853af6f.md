---
chunk_index: 51
ref: "5823c853af6f"
id: "5823c853af6f75a22a84b55d559cb84e6a625fbf9ddb690c8d98da5c2afaa97a"
slug: "claude-model-selection-for-c--user"
path: "/home/zack/dev/llmx/claude_Model selection for current project_2026-01-17.md"
kind: "markdown"
lines: [291, 308]
token_estimate: 546
content_sha256: "cb24b79c73e6125c2d71d402fd05e5452b112081dd71cb501166dfe840c8b9ba"
compacted: false
heading_path: ["Model selection for current project","User"]
symbol: null
address: null
asset_path: null
---

## User

Based on the comprehensive project context provided—spanning Phase 4 (Polish), Phase 5 (Semantic Implementation), and the planning for Phase 6 (Optimization/WebGPU)—I have conducted an alignment review and consolidated the documentation into a professional System Reference Manual.
This response is divided into two parts:
1. Alignment Analysis: Specific modifications needed to align Phase 6 plans with Phase 4 architecture.
2. Master Documentation: A unified, professional reference guide for the development environment.
Part 1: Phase 6 ↔ Phase 4 Alignment Analysis
Status: The alignment is strong, but specific constraints from Phase 4 must be strictly enforced during Phase 6 execution to prevent regression.
1. Modifications Required
AreaPhase 4/5 ConstraintPhase 6 RequirementAction ItemBinary SizeStrict 12MB limit (Release).ONNX Models are ~80MB+.Modification: Do not embed models in the binary. Phase 6 must implement a "download-on-demand" mechanism that stores models in ~/.llmx/models.Tool InterfaceStrictly 4 tools. No llmx_semantic_search.Hybrid search needed.Update: Enforce the use_semantic: Option<bool> flag in SearchInput rather than creating a new tool.ConcurrencyArc<Mutex<IndexStore>> (Stdio optimized).Async/Parallel Embedding generation.Update: Phase 6 must yield to the tokio runtime during embedding generation to prevent blocking the Mutex for too long (preventing other tool calls like llmx_explore).Error HandlingNo panics, strict McpError.ONNX Runtime can panic/fail.Modification: Wrap all ONNX calls in catch_unwind or strictly typed Result handling. Fallback to BM25 silently on model failure (graceful degradation).
2. Architecture Updates
* Index Versioning: The IndexFile struct (Phase 4) needs to strictly enforce the embedding_model string field added in Phase 5. If Phase 6 changes models (e.g., to bge-small), it must trigger a re-index or invalidation of existing vectors.
* Token Budgeting: Phase 4 introduced strict token limits (default 16k). Phase 6's hybrid search must apply this budgeting after the RRF/Linear fusion step, not before, to ensure high-quality chunks aren't truncated early.

---

Evaluate feedback from gemini