---
chunk_index: 848
ref: "369bf141bc17"
id: "369bf141bc17b010dec15ee262b9578201dda82045869a090891a4dcffcdc7e0"
slug: "stable-backport-patches--web-worker-js-add-yield-points-for-gc"
path: "/home/zack/dev/llmx/docs/STABLE_BACKPORT_PATCHES.md"
kind: "markdown"
lines: [176, 189]
token_estimate: 66
content_sha256: "eb66843e3e2d31d0a26741d6cb2a615f4a3d3819fdd1b1393e36ade5204c29b4"
compacted: false
heading_path: ["LLMX Stable - Exact Code Patches to Apply","PATCH 4: Firefox Stability (Priority: HIGH if CPU embeddings used)","web/worker.js - Add yield points for GC"]
symbol: null
address: null
asset_path: null
---

### web/worker.js - Add yield points for GC

**Location:** In embeddings batch loop

**ADD after every 5 batches:**
```javascript
if (batchIndex % 5 === 0) {
  // Yield to allow garbage collection
  await new Promise(resolve => setTimeout(resolve, 0));
}
```

---